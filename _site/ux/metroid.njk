---
layout: false
tags: ux
title: Metroid Password Generator
desc: Generate custom NES Metroid password using a simple interface...
tech:
  - title: HTML
    ico: fa6-brands:html5
  - title: CSS
    ico: fa6-brands:css3-alt
  - title: Twind
    ico: mdi:tailwind
  - title: Alpine.js
    ico: simple-icons:alpinedotjs
ico: mdi:virus
color: orange
date: 0017-01-01
---
<!DOCTYPE html>
<html lang="en" class="bg-transparent" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <title>{{ title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="og:title" content="{{ title }}" />
    <meta property="og:description" content="{{ desc }}" />
    <meta property="og:url" content="{{ site.meta.url }}{{ page.url }}" />
    <meta property="og:image" content="{{ site.meta.url }}/_assets/img/ux/metroid/title.png" />

    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.cdnfonts.com/css/narpassword00000" rel="stylesheet" />
    <style type="text/tailwindcss">
      :root {
        --color-primary: var(--color-warning);
        --color-primary-content: var(--color-warning-content);
        --radius-selector: 0;
        --radius-field: 0;
        --radius-box: 0;
        --depth: 0;
        --noise: 0;
      }

      @theme {
        /* font */
        --font-mono: 'NARPASSWORD00000 fixed.width', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

        /* animate */
        --animate-climb: climb 6s linear infinite;
        @keyframes climb {
          from { background-position: 0 0; }
          to { background-position: 0 78px; }
        }
      }

      @layer base {
        h2 { @apply mb-6 pb-2 border-b border-current/30 text-(--color-warning) text-xs; }
        img { @apply transition; }
        label { @apply relative transition; }
        label:not(:has(.btn)):has(:focus-visible) { @apply outline-2 outline-white outline-offset-4 rounded-sm; }
        input[type=checkbox] { @apply border-0 absolute inset-0 z-10 cursor-pointer appearance-none opacity-0 rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-current; }
        .tippy-content { @apply text-xs; }
      }

      .btn-text { @apply p-0 border-0 h-auto text-gray-500 uppercase no-underline underline-offset-4 rounded-sm checked:text-white checked:underline hover:underline; }

      [x-cloak] { display: none; }
    </style>
  </head>
  <body class="bg-black font-mono uppercase !block" style="display: none;" x-data="app" x-init="updatePassword()">

    <div class="pb-4 px-12 min-h-screen flex flex-col relative before:fixed before:left-0 before:inset-y-0 before:w-8 before:[background-image:url(/_assets/img/ux/metroid/wall.png)] motion-safe:before:animate-climb after:fixed after:right-0 after:inset-y-0 after:w-8 after:[transform:scaleX(-1)] after:[background-image:url(/_assets/img/ux/metroid/wall.png)] motion-safe:after:animate-climb" x-cloak>

      <header class="pt-12 mb-12 w-full shrink-0">
        <hgroup class="flex flex-col items-center gap-2">
          <p><img src="/_assets/img/ux/metroid/title.png" alt="Metroid" class="motion-safe:animate-pulse" /></p>
          <h1 class="text-xs text-success font-black sm:text-base">Password Generator</h1>
        </hgroup>
      </header>

      <main class="pb-12 w-full space-y-12 grow">

        <!-- password -->
        <header class="text-info text-xl flex justify-center normal-case sm:text-2xl md:text-4xl">
          <div class="pt-4 pb-2 border-1 border-current/30 w-[260px] text-center grid grid-cols-2 items-center justify-center gap-2 select-none relative selection:bg-sky-300 selection:text-sky-900 sm:w-[300px] md:w-[440px]">
            <template x-for="(i, index) in 4" hidden>
              <span x-text="maskedPassword[index]"></span>
            </template>
            <button class="appearance-none border border-current/30 w-9 h-9 bg-black text-2xl flex items-center justify-center absolute top-0 right-0 cursor-pointer -translate-y-1/2 translate-x-1/2 transition hover:border-success hover:bg-success hover:text-black" @click="copyPassword"><iconify-icon icon="pixelarticons:clipboard" class="iconify" noobserver></iconify-icon></button>
          </div>
        </header>

        <div class="container mx-auto flex flex-wrap justify-center gap-y-8 gap-x-24">

          <div class="w-full max-w-xs grid grid-cols-1 gap-y-8 gap-x-8 sm:grid-cols-[1fr_auto] md:w-auto md:gap-x-24">
            <!-- location -->
            <section>
              <h2>Location</h2>
              <div class="text-sm flex flex-col items-start gap-2.5">
                <template x-for="item in locations" :key="item.value" hidden>
                  <label><input type="radio" class="btn btn-link btn-sm btn-text" name="location" :value="item.value" x-model="location" @change="updatePassword()" :aria-label="item.title" /></label>
                </template>
              </div>
            </section>

            <!-- suit -->
            <section class="lg:shrink-0">
              <h2>Suit</h2>
              <div class="flex flex-wrap justify-center gap-4">
                <label x-tooltip="'Suit'">
                  <input type="checkbox" x-model="swimsuit" @change="updatePassword()" title="Suit" />
                  <img src="/_assets/img/ux/metroid/samus.png" alt="Suit" :class="swimsuit ? 'object-right' : 'object-left'" class="w-8 h-16 object-cover" />
                </label>
              </div>
            </section>
          </div>

          <div class="w-full max-w-xs grid grid-cols-1 gap-8 md:w-auto">

            <!-- power-ups -->
            <section>
              <h2>Power-Ups</h2>
              <div class="flex flex-wrap gap-4">
                <template x-for="item in power" :key="slugify(item.title)" hidden>
                  <label x-tooltip="item.title">
                    <input type="checkbox" x-model="item.got" @change="updatePassword()" :aria-label="item.title" />
                    <img :src="'/_assets/img/ux/metroid/power-'+ slugify(item.title) +'.png'" :alt="item.title" :class="item.got || 'opacity-70 grayscale'" class="w-8" />
                  </label>
                </template>
              </div>
            </section>

            <!-- loadout -->
            <section>
              <h2>Loadout</h2>
              <div class="flex flex-wrap gap-4">
                <template x-for="item in loadout" :key="slugify(item.title)" hidden>
                  <label x-tooltip="item.title">
                    <input type="checkbox" x-model="item.got" @change="updatePassword()" :aria-label="item.title" />
                    <img :src="'/_assets/img/ux/metroid/loadout-'+ slugify(item.title) +'.png'" :alt="item.title" :class="item.got || 'opacity-70 grayscale'" class="w-8" />
                  </label>
                </template>
              </div>
            </section>
          </div>

          <!-- bosses -->
          <section class="w-full max-w-xs md:w-auto">
            <h2>Bosses</h2>
            <div class="flex flex-col gap-8">
              <div class="flex items-end gap-4">
                <template x-for="(active, name) in bosses" :key="name" hidden>
                  <label x-tooltip="name.charAt(0).toUpperCase() + name.slice(1)">
                    <input type="checkbox" x-model="bosses[name]" @change="updatePassword()" :aria-label="name" />
                    <img :src="'/_assets/img/ux/metroid/boss-'+ name +'.png'" :alt="name" :class="active && 'opacity-70 grayscale'" class="h-16" />
                  </label>
                </template>
                <template x-for="(active, name) in statues" :key="name" hidden>
                  <label class="flex flex-col items-center" :class="name === 'kraid' && 'ml-auto'" x-tooltip="name.charAt(0).toUpperCase() + name.slice(1) +' statue'">
                    <input type="checkbox" x-model="statues[name]" @change="updatePassword()" :aria-label="name +' statue'" />
                    <img :src="'/_assets/img/ux/metroid/statue-'+ name +'.png'" :alt="name" :class="active ? '' : 'opacity-70 grayscale'" class="h-6" />
                    <img src="/_assets/img/ux/metroid/statue-ext.png" alt="Kraid" :class="active ? 'h-4' : 'h-0'" class="w-2.5 transition-all" />
                    <img src="/_assets/img/ux/metroid/statue-base.png" alt="Kraid" :class="active ? '' : 'opacity-70 grayscale'" class="h-4" />
                  </label>
                </template>
              </div>
              <div class="flex items-center justify-between gap-4">
                <label x-tooltip="'Mother Brain'">
                  <input type="checkbox" x-model="brain" @change="updatePassword()" title="Mother Brain" />
                  <img src="/_assets/img/ux/metroid/boss-motherbrain.png" alt="Mother Brain" class="h-24" x-show="!brain" />
                  <img src="/_assets/img/ux/metroid/boss-motherbrain-x.png" alt="Mother Brain" class="h-24 block opacity-70 grayscale" x-show="brain" />
                </label>
                <div class="flex flex-row-reverse gap-1.5">
                  <template x-for="(z, i) in zebetites" :key="i" hidden>
                    <label class="flex flex-col items-center" x-tooltip="'Zebetite '+ (i + 1)">
                      <input type="checkbox" :checked="z" @change="zebetites[i] = !zebetites[i]; updatePassword()" />
                      <img src="/_assets/img/ux/metroid/zebetite-base.png" alt="Zebetite base" class="w-4" />
                      <img src="/_assets/img/ux/metroid/zebetite.png" :alt="'Zebetite '+ (i + 1)" class="h-8 transition-all" :class="zebetites[i] ? 'w-0' : 'w-full'" />
                      <img src="/_assets/img/ux/metroid/zebetite-base.png" alt="Zebetite base" class="w-4 [transform:scaleY(-1)]" />
                    </label>
                  </template>
                </div>
              </div>
            </div>
          </section>
        </div>

      </main>

      <footer class="mt-auto pt-4 border-t border-dashed border-neutral-500/50 w-full text-neutral-500 text-xs text-center shrink-0">By <a href="https://craigerskine.com" class="transition hover:text-white hover:underline">Craig Erskine</a></footer>
    </div>

    <div x-show="toastCopy" class="toast toast-top toast-end" style="display: none;" x-cloak>
      <div class="alert alert-success pb-2 text-xs outline outline-(--color-success) outline-2 outline-offset-2"><span>Password copied to clipboard!</span></div>
    </div>


    <script type="module">
      // icons
      import 'https://esm.run/iconify-icon';

      const METROID_ALPHABET = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz?-";

      function makeBuffer() {
        return new Uint8Array(18);
      }

      function setBit(buffer, bitIndex, value) {
        const byte = Math.floor(bitIndex / 8);
        const bit = bitIndex % 8;
        if (value) {
          buffer[byte] |= (1 << bit);
        } else {
          buffer[byte] &= ~(1 << bit);
        }
      }

      function rotateRight(buffer) {
        const shift = buffer[16] & 0x07;
        for (let r = 0; r < shift; r++) {
          let carry = 1;
          for (let i = 0; i < 16; i++) {
            const newCarry = buffer[i] & 0x01;
            buffer[i] = (buffer[i] >>> 1) | ((carry & 0x01) << 7);
            carry = newCarry;
          }
        }
      }

      function fixChecksum(buffer) {
        let checksum = 0;
        for (let i = 0; i < 17; i++) {
          checksum = (checksum + buffer[i]) % 256;
        }
        buffer[17] = checksum;
      }

      function bufferToPassword(buffer) {
        const chars = [];
        for (let i = 0; i < 6; i++) {
          const j = i * 3;
          const b0 = buffer[j], b1 = buffer[j + 1], b2 = buffer[j + 2];
          chars.push(b0 >> 2);
          chars.push(((b0 & 0x03) << 4) | (b1 >> 4));
          chars.push(((b1 & 0x0F) << 2) | (b2 >> 6));
          chars.push(b2 & 0x3F);
        }
        return chars.map(i => METROID_ALPHABET[i]).join('');
      }

      import Alpine from 'https://esm.run/alpinejs';
      import tippy from 'https://esm.run/tippy.js';
      import 'https://esm.run/tippy.js/dist/tippy.css';
      document.addEventListener('alpine:init', () => {
        Alpine.data('app', () => ({
          toastCopy: false,
          password: [],
          locations: [
            { title: 'Brinstar', value: 'brinstar', },
            { title: 'Norfair', value: 'norfair', },
            { title: 'Kraid\'s Lair', value: 'kraidsLair', },
            { title: 'Ridley\'s Lair', value: 'ridleysLair', },
            { title: 'Tourian', value: 'tourian', },
          ],
          location: 'brinstar',
          swimsuit: false,
          power: {
            morphBall: { title: 'Morph Ball', got: false, },
            bombs: { title: 'Bombs', got: false, },
            highJump: { title: 'High Jump', got: false, },
            variaSuit: { title: 'Varia Suit', got: false, },
            screwAttack: { title: 'Screw Attack', got: false, },
          },
          loadout:{
            longBeam: { title: 'Long Beam', got: false, },
            iceBeam: { title: 'Ice Beam', got: false, },
            waveBeam: { title: 'Wave Beam', got: false, },
            missiles: { title: 'Missiles', got: false, },
            energyTanks: { title: 'Energy Tanks', got: false, },
          },
          bosses: {
            kraid: false,
            ridley: false,
          },
          statues: {
            kraid: false,
            ridley: false,
          },
          zebetites: [false, false, false, false, false],
          brain: false,

          updatePassword() {
            const buffer = new Uint8Array(18);
            const setStartBits = (b0, b1, b2) => {
              setBit(buffer, 64, b0);
              setBit(buffer, 65, b1);
              setBit(buffer, 66, b2);
            };

            switch (this.location) {
              case 'norfair':     setStartBits(1, 0, 0); break;
              case 'kraidsLair':  setStartBits(0, 1, 0); break;
              case 'ridleysLair': setStartBits(0, 0, 1); break;
              case 'tourian':     setStartBits(1, 1, 0); break;
              default:            setStartBits(0, 0, 0); break;
            }

            if (this.swimsuit) setBit(buffer, 71, 1);

            if (this.power.morphBall.got) {
              setBit(buffer, 76, 1);
              setBit(buffer, 0, 0);
              setBit(buffer, 5, 1);
            }
            if (this.power.bombs.got) {
              setBit(buffer, 72, 1);
              setBit(buffer, 6, 1);
            }
            if (this.power.highJump.got) {
              setBit(buffer, 73, 1);
              setBit(buffer, 24, 1);
            }
            if (this.power.variaSuit.got) {
              setBit(buffer, 77, 1);
              setBit(buffer, 11, 1);
            }
            if (this.power.screwAttack.got) {
              setBit(buffer, 75, 1);
              setBit(buffer, 26, 1);
            }
            if (this.loadout.longBeam.got) setBit(buffer, 74, 1);
            if (this.loadout.iceBeam.got)  setBit(buffer, 79, 1);
            if (this.loadout.waveBeam.got) setBit(buffer, 78, 1);

            if (this.loadout.missiles.got) {
              buffer[10] = 255;
              const missileContainerBits = [
                1, 8, 13, 14, 16, 17, 18, 19, 20, 21, 22, 27, 28, 31,
                33, 34, 39, 40, 43, 46, 49
              ];
              missileContainerBits.forEach(bit => setBit(buffer, bit, 1));
            }

            if (this.loadout.energyTanks.got) {
              [4, 9, 12, 30, 36, 42, 45, 48].forEach(bit => setBit(buffer, bit, 1));
            }

            if (this.bosses.kraid) setBit(buffer, 126, 1);
            if (this.bosses.ridley) setBit(buffer, 124, 1);

            if (this.statues.kraid) setBit(buffer, 127, 1);
            if (this.statues.ridley) setBit(buffer, 125, 1);

            this.zebetites.forEach((active, index) => {
              setBit(buffer, 53 + index, active ? 1 : 0);
            });

            if (this.brain) setBit(buffer, 58, 1);

            buffer[16] = 0;
            rotateRight(buffer);
            fixChecksum(buffer);

            const chars = bufferToPassword(buffer);
            this.password = chars.split('');
          },

          get maskedPassword() {
            const p = this.password.join('');
            return p.length === 24
              ? [p.slice(0, 6), p.slice(6, 12), p.slice(12, 18), p.slice(18, 24)]
              : ['', '', '', ''];
          },

          copyPassword() {
            const p = this.password.join('');
            if (p.length === 24) {
              navigator.clipboard.writeText(p).then(() => {
                this.toastCopy = true;
                setTimeout(() => this.toastCopy = false, 1500);
              });
            }
          },

          slugify(text) {
            return text.toString()
              .toLowerCase()
              .trim()
              .replace(/\.+/g, '-')      // . to -
              .replace(/&+/g, '-and-')   // & to -and-
              .replace(/\s+/g, '-')      // space to -
              .normalize('NFKD')         // unicode normalization
              .replace(/[^\w-]+/g, '')   // remove other crazy chars
              .replace(/--+/g, '-')      // multiple - to single -
              .replace(/^-+/, '')        // remove - from start
              .replace(/-+$/, '')        // remove - from end
          },

        }));

        Alpine.magic('tooltip', el => message => {
          let instance = tippy(el, {
            content: message,
            trigger: 'manual',
          });

          // esc
          const onEscape = (e) => {
            if (e.key === 'Escape') cleanup();
          };

          const cleanup = () => {
            instance.hide();
            setTimeout(() => instance.destroy(), 150);
            document.removeEventListener('keydown', onEscape);
            el.removeEventListener('mouseleave', cleanup);
            el.removeEventListener('blur', cleanup);
          };

          document.addEventListener('keydown', onEscape);
          el.addEventListener('mouseleave', cleanup);
          el.addEventListener('blur', cleanup);

          instance.show();

          // fallback timeout
          setTimeout(cleanup, 2000);
        });

        Alpine.directive('tooltip', (el, { expression }, { evaluate }) => {
          const instance = tippy(el, {
            content: evaluate(expression),
          });

          const onEscape = (e) => {
            if (e.key === 'Escape') {
              instance.hide();
            }
          };

          document.addEventListener('keydown', onEscape);

          el._tippyCleanup = () => {
            document.removeEventListener('keydown', onEscape);
            instance.destroy();
          };
        });

        document.addEventListener('alpine:clean', (e) => {
          const el = e.target;
          if (el._tippyCleanup) {
            el._tippyCleanup();
            delete el._tippyCleanup;
          }
        });
      });
      window.Alpine = Alpine;
      // Alpine.plugin([blah]);
      Alpine.start();
    </script>

  </body>
</html>
